<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="preload" as="style" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet" />
    <title>CobblePulse</title>
    <link rel="icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./styles/main.css" />
    <link rel="stylesheet" href="./styles/lazy-loading.css" />
  </head>
  <body>
    <div id="tooltip"><div id="tt-content"></div></div>

    <!-- Loading Skeleton -->
    <div id="loadingSkeleton" class="loading-skeleton">
      <div class="skeleton-header">
        <div class="skeleton-title"></div>
        <div class="skeleton-search"></div>
      </div>
      <div class="skeleton-tabs">
        <div class="skeleton-tab"></div>
        <div class="skeleton-tab"></div>
        <div class="skeleton-tab"></div>
        <div class="skeleton-tab"></div>
        <div class="skeleton-tab"></div>
      </div>
      <div class="skeleton-cards">
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
      </div>
    </div>

    <div class="container" id="app">
      <header>
        <h1>CobblePulse</h1>
        <div class="controls">
          <div class="search-wrapper">
            <input type="text" id="searchInput" placeholder="Search: name, #id, type:fire, ability:levitate, move:earthquake, speed>100" />
            <button class="search-clear" id="searchClear">&times;</button>
          </div>
        </div>
      </header>

      <div class="tabs" id="tabContainer">
        <button class="tab-btn active" data-tab="about">About</button>
        <button class="tab-btn" data-tab="ubers">Ubers</button>
        <button class="tab-btn" data-tab="ou">OU</button>
        <button class="tab-btn" data-tab="uu">UU</button>
        <button class="tab-btn" data-tab="ru">RU</button>
        <button class="tab-btn" data-tab="nu">NU</button>
        <button class="tab-btn" data-tab="pu">PU</button>
        <button class="tab-btn" data-tab="lc">LC</button>
        <button class="tab-btn" data-tab="all">All Cobblemon</button>
        <button class="tab-btn" data-tab="favorites">‚≠ê Favorites</button>
      </div>

      <!-- Unified filter bar -->
      <div class="unified-filters" id="unifiedFilters" style="display:none">
        <select class="filter-dropdown" id="sortSelect">
          <option value="rank">Sort: Rank</option>
          <option value="dex">Sort: Dex #</option>
          <option value="name">Sort: Name A‚ÄìZ</option>
          <option value="type">Sort: Type</option>
        </select>

        <button class="filter-button" id="randomBtn">üé≤ Random</button>

        <div class="filter-chip" id="spawnsChip">
          <span>üìç Has Spawns</span>
        </div>

        <!-- Rarity dropdown -->
        <div class="filter-dropdown-wrapper" id="rarityDropdownWrapper">
          <button class="filter-dropdown-btn" id="rarityDropdownBtn">
            ‚≠ê Rarity ‚ñæ
          </button>
          <div class="filter-dropdown-panel" id="rarityDropdownPanel">
            <div class="rarity-option" data-value="all">All Pok√©mon</div>
            <div class="rarity-option" data-value="legendary">Legendary/Mythical</div>
            <div class="rarity-option active" data-value="non-legendary">Non-Legendary</div>
          </div>
        </div>

        <!-- Types dropdown -->
        <div class="filter-dropdown-wrapper" id="typesDropdownWrapper">
          <button class="filter-dropdown-btn" id="typesDropdownBtn">
            Types <span id="typeCount"></span> ‚ñæ
          </button>
          <div class="filter-dropdown-panel types-panel" id="typesDropdownPanel">
            <!-- Filled dynamically with type badges -->
          </div>
        </div>
      </div>

      <div id="aboutPanel" style="display:none" class="glass-panel"></div>

      <div class="glass-panel table-container" id="tableContainer">
        <table>
          <thead>
            <tr>
              <th>Rank / Dex #</th>
              <th>Sprite</th>
              <th>Name</th>
              <th>Types</th>
            </tr>
          </thead>
          <tbody id="pokemonList"></tbody>
        </table>
      </div>
    </div>

    <div class="modal-overlay" id="modalOverlay">
      <div class="modal-content glass-panel" id="modalContent">
        <button class="close-btn" id="closeBtn">&times;</button>
        <div id="modalBody"></div>
      </div>
    </div>

    <footer class="footer-sources glass-panel">
      <span class="footer-label">Data Assembled From:</span>
      <div class="footer-links">
        <a href="https://www.lumyverse.com/cobbleverse/" target="_blank" class="source-badge">Cobbleverse</a>
        <a href="https://cobblemon.com/" target="_blank" class="source-badge">Cobblemon</a>
        <a href="https://www.smogon.com/" target="_blank" class="source-badge">Smogon</a>
        <a href="https://pokeapi.co/" target="_blank" class="source-badge">Pok√©API</a>
      </div>
      <span id="buildTimestamp" class="build-timestamp" style="display:none;"></span>
    </footer>

    <!-- Scripts loaded in dependency order -->
    <script src="./scripts/imageLoader.js"></script>
    <script src="./scripts/typeChart.js"></script>
    <script src="./scripts/tooltip.js"></script>
    <script src="./scripts/filters.js"></script>
    <script src="./scripts/modal.js"></script>
    <script src="./scripts/main.js"></script>
  </body>
</html>
